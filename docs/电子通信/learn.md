# 光纤传输

## 基本概念

把数据编码成光脉冲（0和1），在玻璃纤维中传播

**衰减 (Attenuation, $\alpha$)：** 光跑得越远，能量越弱。就像手电筒照向远方，光会变暗。你需要每隔一段距离（比如 100 km）就用放大器把信号再次变强 。

**色散 (Dispersion, $\beta_2, \beta_3$)：** 不同颜色的光跑得快慢不一样，导致脉冲变宽、模糊。但在计算非线性噪声时，色散反而能把干扰，稍微减少一点非线性影响 。

**光纤 (100 km)：** 信号在这里传输，发生衰减 ($\alpha$) 和 SRS 功率转移

**放大器 (EDFA)：** 在光纤末端，把衰减掉的能量补回来


## C+L波段介绍：240信道

传统的通信主要用 C波段。但因为流量不够用了，现在必须扩建到 C+L 波段

**C波段：** 120 个信道（频率较高，波长较短）。

**L波段：** 120 个信道（频率较低，波长较长）。

**信道间隔：** 50 GHz

**总带宽：** 约 10-12 THz 





# 光信噪比

## 核心公式

$$
GSNR = \frac{P_{Signal}}{P_{ASE} + P_{NLI}}
$$

为什么需要权衡光信噪比

功率太**低** $\rightarrow$ $P_{Signal}$ 小 $\rightarrow$ 被 $P_{ASE}$ 淹没 $\rightarrow$ GSNR 差

功率太高 $\rightarrow$ $P_{NLI}$ 暴涨 $\rightarrow$ 分母变大 $\rightarrow$ GSNR 差

**优化目标：** 找到一个“刚刚好”的功率（Optimal Launch Power），还要考虑到 C+L 波段之间因为 SRS 导致的能量转移，让最后的 GSNR 最大。



## 光纤：NLI 噪声

**光纤：NLI 噪声** (Nonlinear Interference)

当入纤功率太强时，光纤的折射率会随光强变化（克尔效应），导致信号之间互相干扰（自相位调制 SPM + 交叉相位调制 XPM）

**克尔效应 (Kerr Effect)**：在低功率（线性）光学中，光纤的折射率 $n$ 是一个常数（比如 1.45），不管光强是多少，光的速度都不变。但在高功率下，光纤材料（二氧化硅）会表现出非线性。克尔效应指的是：介质的折射率会随着光强度的增加而发生变化。当光强改变折射率时，它实际上是在抖动光的相位。







NLI噪声可以拆分成两部分：SPM和XPM

### SPM 

SPM (自相位调制, Self-Phase Modulation)：自我干扰

信号光的强度随时间是变化的（0和1的脉冲）。当脉冲最强的时候，折射率变大，光跑得慢；脉冲弱的时候，光跑得快。一个光脉冲的前沿和后沿速度不一致，导致脉冲在频域上**展宽**，甚至变形。这就是 Semrau 论文公式 (10) 计算的内容。





### XPM

XPM (交叉相位调制, Cross-Phase Modulation)：受其他信道干扰

在 C+L 系统中，你有 240 个信道。第 100 信道的光强变化，会瞬间改变整根光纤的折射率，从而导致第 101 信道（以及其他所有信道）的相位发生抖动。这种干扰是随机的（像噪声一样），严重破坏信号质量。这是 Semrau 论文公式 (11) 计算的内容，也是多信道系统中 NLI 的主要来源。







## 放大器：ASE 噪声 

**放大器：ASE 噪声** (Amplified Spontaneous Emission)

 放大器在放大信号的同时，自己也会产生背景声（光噪声）。

这是一种加性噪声。信号越弱，ASE 占比就越大（信噪比越差）。



在 C+L 系统中，放大器通常是分波段的（C波段放大器 + L波段放大器），它们有不同的噪声系数 (Noise Figure, NF) 。你的参数表中，C波段放大器 NF=4.3dB，L波段 NF=5.0dB 







## 受激拉曼散射（SRS）效应导致的功率转移

**受激拉曼散射 (SRS)**：能量会从高频光（波长短）转移到低频光（波长长）。

传统的 C 波段系统中，频带较窄，SRS 效应虽然存在但通常较弱。但在 **C+L 波段** 系统中，频带很宽。位于高频段的 **C 波段信道** 会把能量源源不断地输送给位于低频段的 **L 波段信道**，即使发射端把所有信道的功率都设为一样平坦（比如都是 0dBm），经过一段光纤传输后C 波段（高频）功率大幅下降，导致信噪比（OSNR）变差。L 波段（低频）功率大幅上升，导致信号过强，引发严重的非线性干扰（NLI）。

通过调整发射端的功率（比如预先让 C 波段高一点，L 波段低一点），来抵抗或利用这种倾斜，从而让最后的系统容量最大化。





### 线性拉曼增益近似 

在 C+L 波段的频率范围内（约 10-12 THz），拉曼增益谱 $g_r(\Delta f)$ 可以被近似看作是随频率间隔线性增加的三角形。这大大简化了你的代码编写难度，使得你可以使用闭式公式（Closed-form expression）来计算它对非线性噪声（NLI）的影响 







# 优化策略



## 策略A：一维平坦优化 (ODFPO) 

假设所有 240 个信道的入纤功率都一模一样（比如全是 0dBm），只调节这一个数值。





## 策略 B：二维分段平坦优化 (TDFPO) 

把 C 波段和 L 波段分开看。C 波段所有信道用一个功率，L 波段用另一个功率。



## 策略 C：N维独立优化 (NDIPO) - 理论天花板

240 个信道，每个信道的功率都单独调整。通常使用 粒子群算法 (PSO) 或梯度下降法来找最优解。



### 粒子群算法





### 梯度下降法



##  策略 D：基于输出平坦的优化 (CPDPO) - 论文推荐

强制要求光纤末端（输出端）的功率是平坦的

```c++
public class ConstructorBlockExample {
    {
        // 构造代码块
        System.out.println("构造代码块被执行");
    }

    public ConstructorBlockExample() {
        System.out.println("构造函数被调用");
    }

    public static void main(String[] args) {
        ConstructorBlockExample example = new ConstructorBlockExample();
    }
}
```

